"use strict";exports.id=914,exports.ids=[914],exports.modules={88914:(e,t,n)=>{n.r(t),n.d(t,{MarkdownConverterExtension:()=>Wn});var r=n(17718),i=n(82033),s=n(98436),o=n(55674),a=n.n(o),u=n(2786),l=n(66573),c=n.n(l),h=n(85287),d=n.n(h),m=n(57310),g=n(47678),f=n(28237),p=n.n(f),v=n(33917);const{dirname:y}=d();class D{static get PackageDirectory(){return null===this.packageDirectory&&(this.packageDirectory=y((0,g.T)({cwd:v.InternalConstants.LibraryDirectory}))),this.packageDirectory}static get PackageURL(){return null===this.packageURL&&(this.packageURL=(0,m.pathToFileURL)(this.PackageDirectory)),this.packageURL}static get Puppeteer(){if(null===this.puppeteer){let e=p().constructor;this.puppeteer=new e({projectRoot:this.PackageDirectory})}return this.puppeteer}}var w;D.packageDirectory=null,D.packageURL=null,D.puppeteer=null,function(e){e[e.SelfContainedHTML=0]="SelfContainedHTML",e[e.HTML=1]="HTML",e[e.JPEG=2]="JPEG",e[e.PDF=3]="PDF",e[e.PNG=4]="PNG"}(w=w||(w={}));var C=n(44432);const{join:R}=d();function S(...e){return R(D.PackageDirectory,"Resources",...e)}class x{}x.SystemStyle=S("css","styles.css"),x.DefaultHighlight=S("css","highlight.css"),x.SystemTemplate=S("SystemTemplate.html"),x.HighlightJSStylesDir=R(D.PackageDirectory,"node_modules","highlight.js","styles");let F={SuccessMessage:'Die konvertierte {0}-Datei wurde erfolgreich nach "{1}" geschrieben.',OpenFileLabel:"Datei Öffnen",UncaughtException:"Ein unerwarteter Fehler ist aufgetreten",OperationCancelledException:"Der Vorgang wurde abgebrochen.",FileException:'Auf die Datei "{0}" konnte nicht zugegriffen werden.',FileNotFoundException:'Die Datei "{0}" konnte nicht gefunden werden.',NoConversionType:"Es wurde kein zu konvertierender Datei-Typ ausgewählt. Bitte überprüfen Sie Ihre Einstellungen.",MarkdownFileException:"Es konnte keine Markdown-Datei gefunden werden.",YAMLException:"Fehler: Der YAML-Block ist nicht richtig formatiert. Zeile {0}, Spalte {1}.",UnsupportedPlatformException:"Diese Funktion wird von Ihrer Platform nicht unterstützt!",NoWorkspaceFolderException:"Es ist kein Ordner geöffnet!",CustomBrowserNotFound:"Der in den Einstellungen festgelegte Chromium-Pfad existiert nicht.\nWollen Sie es erneut versuchen?",UpdateMessage:"Bevor Sie mit MarkdownConverter durchstarten können, muss Chromium gedownloadet werden.\nWollen Sie den Download starten?",Yes:"Ja",No:"Nein",UpdateRunning:"Chromium Version {0} wird heruntergeladen… Bitte warten…",UpdateSuccess:"Download abgeschlossen!\nSie sind nun bereit, um MarkdownConverter nutzen zu können!",UpdateFailed:'Der download ist fehlgeschlagen.\nMöglicherweise hilft es, "http.proxy" oder "http.proxyStrictSSL" zu deklarieren, falls Sie eine Proxy nutzen.\nWollen Sie den Download erneut starten?',DestinationPath:"Bitte geben Sie einen Ordner an, in dem Sie die Ausgabedatei ablegen wollen.",DestinationPathExample:"Bspw. C:\\Temp oder /tmp/",Progress:{LaunchWebserver:"Web-Server starten…",LaunchChromium:"Chromium-Browser starten…",ConversionStarting:"Die Konvertierung der Datei zum {0}-Typ wird gestartet…",ResolveFileName:"Ziel-Pfad bestimmen…",WriteHTML:"HTML-Datei generieren und schreiben…",Scrape:"Dateien und Ressourcen abrufen…",ScrapeFolder:"Abgerufene Dateien und Ressourcen in den Ziel-Ordner verschieben…",ChromiumPage:"Website in Chromium öffnen…",PDF:"PDF-Datei generieren…",Screenshot:"Screenshot aufnehmen…",ConverterFinished:"Die Konvertierung der {0}-Datei wurde erfolgreich abgeschlossen",SearchDocuments:"Markdown-Dokumente werden gesucht…",DocumentsFound:"{0} Markdown-Dokumente wurden gefunden",CollectionStep:"Dokument {0} von {1} wird konvertiert…",ChainDocuments:"Dokumente verketten…"},TaskTitle:{Convert:"Dokument Konvertieren",ConvertAll:"Alle Dokumente Konvertieren",Chain:"Alle Dokumente Verketten"},DateTime:{Era:{Before:"v. Chr.",After:"n. Chr."},DateSeparator:".",Formats:{Default:"dd/MM/yyyy",FullDate:"dddd, d. MMMM yyyy"},DaysOfWeek:{ShortNames:["Mo","Di","Mi","Do","Fr","Sa","So"],FullNames:["Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"]},Months:{ShortNames:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],FullNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},TimeDesignator:{ShortNames:["v","n"],FullNames:["vorm.","nachm."]}}},b={SuccessMessage:'Successfully wrote the {0}-file to "{1}".',CollectionFinished:"The documents have been converted successfully. Do you want to show info about the files?",OpenFileLabel:"Open File",UncaughtException:"An unexpected error occurred",UnknownException:"{{UncaughtException}}:\n{0}: {1}",UnknownError:"{{UncaughtException}}:\n{0}",OperationCancelledException:"The operation has been cancelled.",FileException:'Couldn\'t access "{0}".',FileNotFoundException:'The file "{0}" couldn\'t be found.',NoConversionType:"No conversion type was selected. Please review your settings.",MarkdownFileException:"Couldn't find a markdown-file.",YAMLException:"The YAML-block is malformed. Line {0}, column {1}.",UnsupportedPlatformException:"This feature is not supported by your platform!",NoWorkspaceFolderException:"No workspace-folder is opened!",CustomBrowserNotFound:"The configured chromium-path does not exist. You might want to review this setting.\nDo you want to retry?",UpdateMessage:"Before you can get started with MarkdownConverter you need to download chromium.\nDo you want to do this now?",Yes:"Yes",No:"No",UpdateRunning:"Downloading Chromium revision {0}… Please wait…",UpdateSuccess:"The download was successful!\nYou are ready to use MarkdownConverter now!",UpdateFailed:'The download failed.\nYou may want to declare "http.proxy" or "http.proxyStrictSSL" if you\'re using a proxy.\nDo you want to retry the download?',DestinationPath:"Please specify a destination-path to save the document to.",DestinationPathExample:"e.g. C:\\Temp or /tmp/",DocumentName:"Please specify the name of the document to create.",DocumentNameExample:"e.g. Handbook or Manual",Progress:{LaunchWebserver:"Initializing a web-server…",LaunchChromium:"Launching a chromium-instance…",ConversionStarting:"Starting to convert the file to the {0}-type…",ResolveFileName:"Resolving the destination-filename…",WriteHTML:"Rendering and writing html-file…",Scrape:"Scraping all files and resources…",ScrapeFolder:"Moving the scraped files to the correct folder…",ChromiumPage:"Launching the page in chromium…",PDF:"Rendering a PDF-file…",Screenshot:"Taking a screenshot…",ConverterFinished:"The conversion of the {0}-file has finished",SearchDocuments:"Searching for markdown-documents…",DocumentsFound:"Found {0} markdown-documents",CollectionStep:"Converting document {0} out of {1}…",ChainDocuments:"Chaining all documents together…"},TaskTitle:{Convert:"Convert Document",ConvertAll:"Convert all Documents",Chain:"Chain all Documents"},DateTime:{Era:{Before:"B.C.",After:"A.D."},TimeSeparator:":",DateSeparator:"-",Formats:{Default:"yyyy/MM/dd",FullDate:"dddd, MMMM d, yyyy"},DaysOfWeek:{ShortNames:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],FullNames:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]},Months:{ShortNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],FullNames:["January","February","March","April","May","June","July","August","September","October","November","December"]},TimeDesignator:{ShortNames:["A","P"],FullNames:["AM","PM"]}}};class P{static set Culture(e){this.Resources.Locale=this.Files.Locale=e}static get Resources(){return null===this.resources&&(this.resources=new C.Rq(new C.fc([new C._z(b),new C._z(F,new C.Qs("de"))]))),this.resources}static get Files(){return null===this.files&&(this.files=new C.fc([new C._z(x)])),this.files}}P.resources=null,P.files=null;var T,E,k,L,M,G,N=n(90050);!function(e){e[e.Link=0]="Link",e[e.AbsolutePath=1]="AbsolutePath",e[e.RelativePath=2]="RelativePath"}(T=T||(T={})),function(e){e[e.Default=0]="Default",e[e.Link=1]="Link",e[e.Include=2]="Include"}(E=E||(E={}));class A{}class I extends A{constructor(e,t){super(),this.width=e,this.height=t}get Width(){return this.width}set Width(e){this.width=e}get Height(){return this.height}set Height(e){this.height=e}get PDFOptions(){return{width:this.Width,height:this.Height}}}!function(e){e[e.None=0]="None",e[e.Native=1]="Native",e[e.GitHub=2]="GitHub",e[e.Twitter=3]="Twitter"}(k=k||(k={})),function(e){e[e.Unordered=0]="Unordered",e[e.Ordered=1]="Ordered"}(L=L||(L={})),function(e){e[e.Portrait=0]="Portrait",e[e.Landscape=1]="Landscape"}(M=M||(M={}));class U{constructor(e,t,n,r){this.top=this.right=this.bottom=this.left=e,t&&(this.left=this.right=t),n&&(this.bottom=n),r&&(this.left=r)}get Top(){return this.top}set Top(e){this.top=e}get Right(){return this.right}set Right(e){this.right=e}get Bottom(){return this.bottom}set Bottom(e){this.bottom=e}get Left(){return this.left}set Left(e){this.left=e}}!function(e){e.A0="a0",e.A1="a1",e.A2="a2",e.A3="a3",e.A4="a4",e.A5="a5",e.A6="a6",e.Legal="legal",e.Letter="letter",e.Tabloid="tabloid",e.Ledger="ledger"}(G=G||(G={}));class O extends A{constructor(e=G.A4,t=M.Portrait){super(),this.format=e,this.orientation=t}get Format(){return this.format}set Format(e){this.format=e}get Orientation(){return this.orientation}set Orientation(e){this.orientation=e}get PDFOptions(){return{format:this.Format,landscape:this.Orientation===M.Landscape}}}class H{constructor(e,t){this.margin=new U("1cm"),this.format=new O,e&&(this.format=e),t&&(this.margin=t)}get Margin(){return this.margin}set Margin(e){this.margin=e}get Format(){return this.format}set Format(e){this.format=e}}class ${constructor(e,t=new N.wT([]),n=/\[\[\s*toc\s*\]\]/g,r=L.Unordered){this.class=e,this.levels=t,this.indicator=n,this.listType=r}get Class(){return this.class}set Class(e){this.class=e}get Levels(){return this.levels}set Levels(e){this.levels=e}get Indicator(){return this.indicator}set Indicator(e){this.indicator=e}get ListType(){return this.listType}set ListType(e){this.listType=e}}const{env:j,workspace:z}=(0,i.createRequire)(D.PackageURL)("vscode");class W{constructor(){}static get Default(){return this.defaultInstance||(this.defaultInstance=new W),W.defaultInstance}get ChromiumExecutablePath(){return this.GetConfigEntry("ChromiumExecutablePath")}get ChromiumArgs(){return this.GetConfigEntry("ChromiumArgs")}get DestinationPattern(){return this.GetConfigEntry("DestinationPattern")}get IgnoreLanguageMode(){return this.GetConfigEntry("IgnoreLanguageMode")}get ConversionQuality(){return this.GetConfigEntry("ConversionQuality")}get ConversionType(){let e=[],t=this.GetConfigEntry("ConversionType",[w[w.PDF]]);for(let n of t)e.push(w[n]);return e}get Locale(){var e;return null!==(e=this.GetConfigEntry("Locale"))&&void 0!==e?e:j.language}get DefaultDateFormat(){return this.GetConfigEntry("DefaultDateFormat")}get DateFormats(){return this.GetConfigEntry("DateFormats")}get EmojiType(){return k[this.GetConfigEntry("Parser.EmojiType")]}get Attributes(){return this.GetConfigEntry("Document.Attributes")}get PaperFormat(){let e=new H,t=new Object,n="Document.Paper",r=`${n}.PaperFormat`,i=`${r}.Width`,s=`${r}.Height`;if(this.config.has(i)&&this.config.has(s))e.Format=new I(this.GetConfigEntry(i),this.GetConfigEntry(s));else{let t=new O;t.Format=G[this.GetConfigEntry(`${r}.Format`,"A4")],t.Orientation=M[this.GetConfigEntry(`${r}.Orientation`,M[M.Portrait])],e.Format=t}for(let r of["Top","Left","Bottom","Right"]){let i=`${n}.Margin.${r}`;this.GetConfigEntry(i,t)!==t&&(e.Margin[r]=this.GetConfigEntry(i))}return e}get HeaderFooterEnabled(){return this.GetConfigEntry("Document.HeaderFooterEnabled")}get HeaderContent(){return this.GetConfigEntry("Document.HeaderContent")}get HeaderTemplate(){return this.GetConfigEntry("Document.HeaderTemplate")}get FooterContent(){return this.GetConfigEntry("Document.FooterContent")}get FooterTemplate(){return this.GetConfigEntry("Document.FooterTemplate")}get MetaTemplate(){return this.GetConfigEntry("Document.MetaTemplate")}get DefaultStylesEnabled(){return this.GetConfigEntry("Document.DefaultStyles")}get TocSettings(){if(this.GetConfigEntry("Parser.Toc.Enabled")){let e=this.GetConfigEntry("Parser.Toc.Class"),t=this.GetConfigEntry("Parser.Toc.Levels"),n=new RegExp(this.GetConfigEntry("Parser.Toc.Indicator"),"im"),r="ol"===this.GetConfigEntry("Parser.Toc.ListType")?L.Ordered:L.Unordered;return new $(e,new N.wT(t),n,r)}return null}get Template(){return this.GetConfigEntry("Document.Template")}get HighlightStyle(){return this.GetConfigEntry("Document.HighlightStyle")}get SystemParserEnabled(){return this.GetConfigEntry("Parser.SystemParserEnabled")}get StyleSheetInsertion(){return this.LoadInsertionTypes("Assets.StyleSheetInsertion")}get StyleSheets(){return this.LoadAssets("Assets.StyleSheets")}get ScriptInsertion(){return this.LoadInsertionTypes("Assets.ScriptInsertion")}get Scripts(){return this.LoadAssets("Assets.Scripts")}get PictureInsertion(){return this.LoadInsertionTypes("Assets.PictureInsertion")}get config(){return z.getConfiguration(W.ConfigKey)}GetConfigEntry(e,t){return this.config.get(e,t)}LoadInsertionTypes(e){let t={};for(let n of Object.entries(this.GetConfigEntry(e)))t[T[n[0]]]=E[n[1]];return t}LoadAssets(e){return Object.fromEntries(Object.entries(this.GetConfigEntry(e)).map((e=>[e[0],E[e[1]]])))}}W.ConfigKey="markdownConverter",W.defaultInstance=null;class B extends Error{constructor(e,t){super(),this.exceptionMessage=null,this.innerException=null,e&&(this.exceptionMessage=e),t&&(this.innerException=t)}get Data(){return this.data}get InnerException(){return this.innerException}get Message(){return this.exceptionMessage}get message(){return this.Message}get StackTrace(){return this.stack}toString(){return this.Message}}var q=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};const{dirname:Y}=d(),{commands:J,env:V,ProgressLocation:_,ViewColumn:Q,window:K,workspace:Z}=(0,i.createRequire)(D.PackageURL)("vscode");class X extends B{constructor(e){super(e)}get Message(){var e;return null!==(e=super.Message)&&void 0!==e?e:P.Resources.Get("OperationCancelledException")}}var ee=n(70612),te=n(21186),ne=n.n(te);class re extends B{}class ie extends re{constructor(e,t,n){super(e,n),this.Path=t}get Message(){var e;return null!==(e=super.Message)&&void 0!==e?e:c()(P.Resources.Get("FileException"),this.Path)}}class se extends ie{constructor(e,t,n){super(t,e,n)}get Message(){var e;return null!==(e=super.Message)&&void 0!==e?e:c()(P.Resources.Get("FileNotFoundException"),this.Path)}}class oe extends se{constructor(){super(null,null)}get Message(){return P.Resources.Get("MarkdownFileException")}}class ae extends B{constructor(){super(P.Resources.Get("NoWorkspaceFolderException"),null)}get Message(){var e;return null!==(e=super.Message)&&void 0!==e?e:P.Resources.Get("NoWorkspaceFolderException")}}var ue=n(17836),le=n(20637),ce=n(83465),he=n.n(ce),de=n(9980),me=n.n(de),ge=n(60717),fe=n.n(ge),pe=n(40591),ve=n.n(pe),ye=n(46635),De=n.n(ye),we=n(8367),Ce=n.n(we),Re=n(71174),Se=n.n(Re),xe=n(88849),Fe=n(41041),be=n(47261),Pe=n(66518),Te=n.n(Pe),Ee=n(5354),ke=n(12884),Le=n.n(ke),Me=n(58567),Ge=n.n(Me),Ne=n(5268),Ae=n(39224),Ie=n.n(Ae),Ue=n(76483),Oe=n(49411),He=n(54700),$e=n.n(He),je=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};const{readFile:ze}=a(),{isAbsolute:We}=d(),{Uri:Be}=(0,i.createRequire)(D.PackageURL)("vscode");class qe{constructor(e,t,n){this.docRoot=null,this.url=e,this.insertionType=null!=t?t:E.Default,this.docRoot=n}get URL(){return this.url}get URLType(){let e;try{Be.parse(this.URL,!0),e=!We(this.URL)}catch(t){e=!1}return e?T.Link:We(this.URL)?T.AbsolutePath:T.RelativePath}get InsertionType(){return this.insertionType}set InsertionType(e){this.insertionType=e}get DocRoot(){return this.docRoot}Render(){return je(this,void 0,void 0,(function*(){return this.GetInsertionType()===E.Link?this.GetReferenceSource():this.GetSource()}))}GetInsertionType(){return this.InsertionType!==E.Default?this.InsertionType:this.URLType===T.Link?E.Link:E.Include}ReadFile(){var e;return je(this,void 0,void 0,(function*(){return this.URLType===T.Link?new Promise(((e,t)=>{$e()(this.URL,((n,r)=>{if(n)t(n);else{let n=[];r.on("data",(e=>{n.push(Buffer.from(e))})),r.on("error",(e=>{t(e)})),r.on("end",(()=>{e(Buffer.concat(n))}))}}))})):ze((0,Oe.resolve)(null!==(e=this.DocRoot)&&void 0!==e?e:"",this.URL))}))}}var Ye=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};const Je="style",Ve="link";class _e extends qe{constructor(e,t,n){super(e,t,n)}GetSource(){return Ye(this,void 0,void 0,(function*(){let e=(0,Ue.zD)((0,Ue.zD)("<style></style>")(Je).toArray()[0]);return e(Je).text((yield this.ReadFile()).toString()),`${e.html()}\n`}))}GetReferenceSource(){return Ye(this,void 0,void 0,(function*(){let e=(0,Ue.zD)((0,Ue.zD)("<link />")(Ve).toArray()[0]),t=e(Ve);return t.attr("rel","stylesheet"),t.attr("type","text/css"),t.attr("href",this.URL),`${e.html()}\n`}))}}var Qe,Ke=n(65831),Ze=n.n(Ke);class Xe extends B{constructor(e,t,n,r,i){if(super(...1===arguments.length?[null,e]:[r,i]),1===arguments.length){let t=e;this.name=t.name,this.reason=t.reason,this.marker=t.mark}else this.name=e,this.reason=t,this.marker=n}get Name(){return this.name}get Message(){var e;return null!==(e=super.Message)&&void 0!==e?e:c()(P.Resources.Get("YAMLException"),this.Marker.line+1,this.Marker.column+1)}get Marker(){return this.marker}get Reason(){return this.reason}}!function(e){e.Title="Title",e.Author="Author",e.DateFormat="DateFormat",e.CreationDate="CreationDate",e.ChangeDate="ChangeDate",e.CurrentDate="CurrentDate",e.MetaTemplate="MetaTemplate",e.Header="Header",e.HeaderTemplate="HeaderTemplate",e.Footer="Footer",e.FooterTemplate="FooterTemplate"}(Qe=Qe||(Qe={}));var et=n(14102),tt=n.n(et),nt=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};class rt{static GetFullName(){return nt(this,void 0,void 0,(function*(){let e=[];e=[()=>nt(this,void 0,void 0,(function*(){return this.CheckEnv()})),()=>nt(this,void 0,void 0,(function*(){return this.CheckGit()}))],"win32"===process.platform?e.push(this.CheckWmic):"darwin"===process.platform&&e.push(this.CheckOsaScript);for(let t of e)try{let e=yield t();if(e)return e.trim()}catch(e){}return""}))}static ExecuteCommand(e){return nt(this,void 0,void 0,(function*(){let t=yield(0,be.promisify)(r.exec)(e);if(t.stderr)throw new Error(t.stderr);return t.stdout}))}static CheckEnv(){let e=process.env,t=this.envVars.filter((t=>t in e));for(let n of t)if(null!==e[n])return e[n];return null}static CheckGit(){return nt(this,void 0,void 0,(function*(){return this.ExecuteCommand("git config --global user.name")}))}static CheckWmic(){return nt(this,void 0,void 0,(function*(){return(yield this.ExecuteCommand('wmic useraccount where name="%username%" get fullname')).replace("FullName","").trim()}))}static CheckOsaScript(){return nt(this,void 0,void 0,(function*(){return this.ExecuteCommand("osascript -e long user name of (system info)")}))}}rt.envVars=["GIT_AUTHOR_NAME","GIT_COMMITTER_NAME","HGUSER","C9_USER"];class it{constructor(e){this.locale=null,this.pattern=/d{1,4}|f{1,7}|\.?F{1,7}|g{1,2}|h{1,2}|H{1,2}|m{1,2}|M{1,4}|s{1,2}|t{1,2}|y+|:|\/|o|\\.|'[^']*'|"[^"]*"|\\./g,e&&(this.Locale=e)}get Locale(){return this.locale}set Locale(e){this.locale=e}Format(e,t=new Date){try{e=this.GetResource("Formats."+e)}catch(e){}return e.replace(this.pattern,(e=>{if(/^d{1,2}$/g.test(e))return t.getDate().toString().padStart(e.length,"0");if(/^d{3,4}$/g.test(e)){let n="DaysOfWeek",r=t.getDay()-1;return r<0&&(r=6),"ddd"===e?this.GetResource(`${n}.ShortNames`)[r]:this.GetResource(`${n}.FullNames`)[r]}if(/^f+$/g.test(e))return t.getMilliseconds().toString().padStart(2,"0").padEnd(e.length,"0").slice(0,e.length);if(/^\.?F+$/g.test(e)){if(t.getMilliseconds()>0){let n=e.replace(/^(\.?)F+$/g,"$1"),r=e.replace(/^\.?(F+)$/g,"$1");return r=t.getMilliseconds().toString().slice(0,e.length).replace(/0*$/g,""),r.length>0?n+r:""}return""}if(/^g+$/g.test(e))return this.GetResource("Era."+(t.getFullYear()<0?"Before":"After"));if(/^h+$/g.test(e))return(t.getHours()%12||12).toString().padStart(e.length,"0");if(/^H+$/g.test(e))return t.getHours().toString().padStart(e.length,"0");if(/^m+$/g.test(e))return t.getMinutes().toString().padStart(e.length,"0");if(/^M{1,2}$/g.test(e))return(t.getMonth()+1).toString().padStart(e.length,"0");if(/^M{3,4}$/g.test(e)){let n="Months",r=t.getMonth();return"MMM"===e?this.GetResource(`${n}.ShortNames`)[r]:this.GetResource(`${n}.FullNames`)[r]}if(/^s+$/g.test(e))return t.getSeconds().toString().padStart(e.length,"0");if(/^t+$/g.test(e)){let n="TimeDesignator",r=t.getHours()<12;return"t"===e?this.GetResource(`${n}.ShortNames`)[r?0:1]:this.GetResource(`${n}.FullNames`)[r?0:1]}return/^y{1,2}$/g.test(e)?parseInt(Math.abs(t.getFullYear()).toString().slice(-2),10).toString().padStart(e.length,"0"):/^y+$/g.test(e)?Math.abs(t.getFullYear()).toString().slice(-e.length).padStart(e.length,"0"):/^:$/g.test(e)?this.GetResource("TimeSeparator"):/^\/$/g.test(e)?this.GetResource("DateSeparator"):/^'.*'|".*"$/g.test(e)?e.slice(1,e.length-1):/^\\.$/g.test(e)?e[1]:e}))}GetResource(e){return P.Resources.Get(`DateTime.${e}`,this.Locale)}}var st,ot=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};class at extends qe{constructor(e,t,n){super(t,n),this.document=e}get Document(){return this.document}get DocRoot(){return this.Document.FileName?(0,Oe.dirname)(this.Document.FileName):null}GetInsertionType(){return this.InsertionType===E.Default?E.Link:super.GetInsertionType()}GetSource(){return ot(this,void 0,void 0,(function*(){if(this.URLType!==T.RelativePath||this.DocRoot){let e,t=(0,Oe.extname)(this.URL).slice(1);return e="jpg"===t?"jpeg":"svg"===t?t+"+xml":t,`data:image/${e};base64,${(yield this.ReadFile()).toString("base64")}`}return this.GetReferenceSource()}))}GetReferenceSource(){return ot(this,void 0,void 0,(function*(){return this.URL}))}}!function(e){e.FormatDate="FormatDate"}(st=st||(st={}));class ut{constructor(e=""){this.content=e}get Content(){return this.content}set Content(e){this.content=e}Render(){return this.RenderContent()}}var lt=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};const{statSync:ct}=a();class ht extends ut{constructor(e){super(),this.renderer=null,this.document=e}get Renderer(){return null===this.renderer&&(this.renderer=tt().create(),this.Renderer.registerHelper(st.FormatDate,((e,t)=>this.FormatDate(e,t)))),this.renderer}get Document(){return this.document}Render(){const e=Object.create(null,{Render:{get:()=>super.Render}});return lt(this,void 0,void 0,(function*(){let t=(0,Ue.zD)(yield e.Render.call(this),void 0,!1);return yield Promise.all(t("img").map(((e,n)=>{var r;let i=t(n).attr("src"),s=new at(this.Document,i);return s.InsertionType=null!==(r=this.Document.PictureInsertionTypes.get(s.URLType))&&void 0!==r?r:E.Default,(()=>lt(this,void 0,void 0,(function*(){return t(n).attr("src",yield s.Render())})))()}))),t.html()}))}RenderContent(){return lt(this,void 0,void 0,(function*(){let e=Object.assign({},this.Document.Attributes),t=[],n=[Qe.CreationDate,Qe.ChangeDate,Qe.CurrentDate],r=[...n,Qe.Title,Qe.Author],i=e=>{if(!this.Document.FileName)return new Date;switch(e){case Qe.CreationDate:return ct(this.Document.FileName).birthtime;case Qe.ChangeDate:return ct(this.Document.FileName).mtime;case Qe.CurrentDate:default:return new Date}};for(let t of r)if(!(t in e))if(n.includes(t))e[t]=i(t);else switch(t){case Qe.Title:e[t]=this.Document.Title;break;case Qe.Author:e[t]=yield rt.GetFullName()}for(let n in e){let r=e[n];r instanceof Date&&(t.push(n),this.Renderer.registerHelper(n,(e=>this.FormatDate(r,"string"==typeof e?e:this.Document.DefaultDateFormat))))}let s=this.RenderTemplate(this.Content,e);for(let e of t)this.Renderer.unregisterHelper(e);return s}))}RenderTemplate(e,t){return lt(this,void 0,void 0,(function*(){return this.Renderer.compile(e)(t)}))}FormatDate(e,t){return null!=t||(t=this.Document.DefaultDateFormat),t?new it(this.Document.Locale).Format(t in this.Document.DateFormats?this.Document.DateFormats[t]:t,new Date(e)):e.toString()}}var dt;!function(e){e.RootDir="markdown-converter-root-dir"}(dt=dt||(dt={}));const{dirname:mt}=d();class gt extends ht{constructor(e){super(e)}RenderContent(){const e=Object.create(null,{RenderContent:{get:()=>super.RenderContent}});return t=this,n=void 0,i=function*(){return this.Document.Parser.render(yield e.RenderContent.call(this),{[dt.RootDir]:this.Document.FileName?mt(this.Document.FileName):null})},new((r=void 0)||(r=Promise))((function(e,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,a)}u((i=i.apply(t,n||[])).next())}));var t,n,r,i}}class ft extends ht{constructor(e){super(e),this.left=new ht(this.Document),this.right=new ht(this.Document),this.center=new ht(this.Document)}get Left(){return this.LeftSection.Content}set Left(e){this.LeftSection.Content=e}get Right(){return this.RightSection.Content}set Right(e){this.RightSection.Content=e}get Center(){return this.center.Content}set Center(e){this.center.Content=e}get LeftSection(){return this.left}get RightSection(){return this.right}get CenterSection(){return this.center}RenderTemplate(e,t){const n=Object.create(null,{RenderTemplate:{get:()=>super.RenderTemplate}});return r=this,i=void 0,o=function*(){return n.RenderTemplate.call(this,e,Object.assign(Object.assign({},t),{Left:yield this.LeftSection.Render(),Right:yield this.RightSection.Render(),Center:yield this.CenterSection.Render()}))},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{u(o.next(e))}catch(e){t(e)}}function a(e){try{u(o.throw(e))}catch(e){t(e)}}function u(t){var r;t.done?e(t.value):(r=t.value,r instanceof s?r:new s((function(e){e(r)}))).then(n,a)}u((o=o.apply(r,i||[])).next())}));var r,i,s,o}}class pt extends ut{constructor(e,t){super(),this.fileName=null,this.quality=90,this.attributes={},this.defaultDateFormat="Default",this.dateFormats={},this.locale=C.Qs.InvariantCulture,this.paper=new H,this.body=new gt(this),this.headerFooterEnabled=!1,this.header=new ft(this),this.footer=new ft(this),this.meta=new ht(this),this.template=Te()('\n        <!DOCTYPE html>\n        <html>\n            <head>\n                <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">\n                {{{ meta }}}\n                {{{ styles }}}\n            </head>\n            <body class="markdown-body">\n                {{{ content }}}\n                {{{ scripts }}}\n            </body>\n        </html>'),this.styleSheets=[],this.scripts=[],this.pictureInsertionTypes=new Map,t?(this.RawContent=t.getText(),this.fileName=t.isUntitled?null:t.fileName,t.isUntitled?this.title=t.uri.fsPath:(this.fileName=t.fileName,this.title=(0,Oe.parse)(this.FileName).name)):this.title="Untitled",this.parser=e,this.Meta.Content=Te()("\n                <title>{{{ Title }}}</title>")}get FileName(){return this.fileName}get Title(){var e;return null!==(e=this.Attributes[Qe.Title])&&void 0!==e?e:this.title}get RawContent(){return"---\n"+Ze().stringify(this.Attributes).trim()+"\n---\n"+this.Content}set RawContent(e){try{let t=ne()(e);this.Attributes=t.attributes,this.Content=t.body}catch(e){throw new Xe(e)}}get Content(){return this.Body.Content}set Content(e){this.Body.Content=e}get Quality(){return this.quality}set Quality(e){this.quality=e}get Attributes(){return this.attributes}set Attributes(e){this.attributes=e}get DefaultDateFormat(){return this.defaultDateFormat}set DefaultDateFormat(e){this.defaultDateFormat=e}get DateFormats(){return this.dateFormats}set DateFormats(e){this.dateFormats=e}get Locale(){return this.locale}set Locale(e){this.locale=e}get Paper(){return this.paper}set Paper(e){this.paper=e}get HeaderFooterEnabled(){return this.headerFooterEnabled}set HeaderFooterEnabled(e){this.headerFooterEnabled=e}get Header(){return this.header}get Footer(){return this.footer}get Meta(){return this.meta}get Template(){return this.template}set Template(e){this.template=e}get StyleSheets(){return this.styleSheets}set StyleSheets(e){this.styleSheets=e}get Scripts(){return this.scripts}set Scripts(e){this.scripts=e}get PictureInsertionTypes(){return this.pictureInsertionTypes}get Parser(){return this.parser}get Body(){return this.body}RenderContent(){return e=this,t=void 0,r=function*(){let e="",t="";for(let t of this.StyleSheets)e+=(yield t.Render());for(let e of this.Scripts)t+=(yield e.Render());let n={meta:yield this.Meta.Render(),styles:e,scripts:t,content:yield this.Body.Render()};return this.Body.Renderer.compile(this.Template)(n)},new((n=void 0)||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}));var e,t,n,r}}var vt=n(57458),yt=n.n(vt),Dt=n(2290),wt=n.n(Dt),Ct=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};const{join:Rt,parse:St}=d(),{encode:xt}=yt();class Ft{constructor(e,t){this.converter=e,this.websiteName=t}get Converter(){return this.converter}get WebsiteName(){return this.websiteName}apply(e){let t,n,r,i;e("beforeStart",(({options:e})=>Ct(this,void 0,void 0,(function*(){var s;let o=[...this.Converter.ChromiumArgs];try{t=yield D.Puppeteer.launch(Object.assign(Object.assign({},this.Converter.BrowserOptions),{args:o}))}catch(e){t=yield D.Puppeteer.launch(Object.assign(Object.assign({},this.Converter.BrowserOptions),{args:[...o,"--no-sandbox"]}))}n=[],r=e.subdirectories,i=null!==(s=this.WebsiteName)&&void 0!==s?s:e.defaultFilename})))),e("afterResponse",(({response:e})=>Ct(this,void 0,void 0,(function*(){if(e.request.href===this.Converter.URL)return xt(yield this.Converter.Document.Render());{let n=e.headers["content-type"];if(n&&"text/html"===n.split(";")[0]){let n=e.request.href,r=yield t.newPage();yield r.goto(n);let i=yield r.content();return yield r.close(),i}return e.body}})))),e("generateFilename",(({resource:e})=>{let t,s=wt()(e,{subdirectories:r,defaultFilename:i},n);return t="index.html"===s?s=this.WebsiteName:Rt(St(i).name,s),n.push(s),{filename:t}}))}}var bt=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};const{ensureDir:Pt,move:Tt,pathExists:Et,remove:kt,writeFile:Lt}=a(),{glob:Mt}=Le(),{basename:Gt,dirname:Nt,join:At,relative:It}=d();class Ut{constructor(e,t){this.chromiumExecutablePath=null,this.chromiumArgs=[],this.initialized=!1,this.disposed=!1,this.documentRoot=e,this.document=t}get DocumentRoot(){return this.documentRoot}get Document(){return this.document}get Initialized(){return this.initialized}get Disposed(){return this.disposed}get URL(){return this.Initialized?new Fe.URL(this.WebDocumentName,`http://localhost:${this.PortNumber}/`).href:null}get PortNumber(){return this.Initialized?this.portNumber:null}get WebDocumentName(){return(this.Document.FileName&&this.DocumentRoot?(0,Ne.Ro)(It(this.DocumentRoot,this.Document.FileName)):"index")+".html"}get WebServer(){return this.Initialized?this.webServer:null}get ChromiumExecutablePath(){return this.chromiumExecutablePath}set ChromiumExecutablePath(e){this.chromiumExecutablePath=e}get ChromiumArgs(){return this.chromiumArgs}set ChromiumArgs(e){this.chromiumArgs=e}get BrowserOptions(){return Object.assign({},this.ChromiumExecutablePath?{executablePath:this.ChromiumExecutablePath}:{})}get Browser(){return this.Initialized?this.browser:null}Initialize(e){return bt(this,void 0,void 0,(function*(){if(this.Initialized||this.Disposed)throw new Error("The converter cannot be re-initialized.");null==e||e.report({message:P.Resources.Get("Progress.LaunchWebserver")}),this.portNumber=yield(0,Ee.Z)(),this.webServer=(0,xe.createServer)(((e,t)=>bt(this,void 0,void 0,(function*(){let n=[];if(new Fe.URL(e.url,`http://${e.headers.host}`).href===this.URL)try{let e=yield this.Document.Render();for(let e of n)t.setHeader(e[0],e[1]);t.writeHead(200),t.write(e)}catch(e){let n=new pt(new(me()));n.StyleSheets.push(new _e(P.Files.Get("SystemStyle"),E.Include)),n.Content=Te()(`\n                                    # An Error Occurred While Converting the Document\n                                    ~~~\n                                    ${e}\n                                    ~~~`),t.writeHead(500),t.write(yield n.Render())}finally{t.end()}else Ge()(e,t,{public:this.DocumentRoot,headers:[{source:"**/*.*",headers:n.map((e=>({key:e[0],value:e[1]})))}],cleanUrls:!1})})))),this.webServer.listen(this.portNumber,"localhost"),null==e||e.report({message:P.Resources.Get("Progress.LaunchChromium")});try{this.browser=yield D.Puppeteer.launch(Object.assign(Object.assign({},this.BrowserOptions),{args:[...this.ChromiumArgs]}))}catch(e){this.browser=yield D.Puppeteer.launch(Object.assign(Object.assign({},this.BrowserOptions),{args:[...this.ChromiumArgs,"--no-sandbox"]}))}this.initialized=!0}))}Dispose(){return bt(this,void 0,void 0,(function*(){this.Initialized&&(yield this.browser.close(),yield new Promise((e=>{this.WebServer.close((()=>e()))}))),this.initialized=!1,this.disposed=!0}))}Start(e,t,n,r){var i;return bt(this,void 0,void 0,(function*(){if(!this.Initialized)throw new Error("The converter must be initialized in order to use it.");if(null==r?void 0:r.isCancellationRequested)throw new X;switch(yield Pt(Nt(t)),e){case w.HTML:null==n||n.report({message:P.Resources.Get("Progress.WriteHTML")}),yield Lt(t,yield this.Document.Render());break;case w.SelfContainedHTML:let s=new ue.F7;yield kt(s.FullName),null==n||n.report({message:P.Resources.Get("Progress.Scrape")}),yield Ie()({urls:[this.URL],directory:s.FullName,plugins:[new Ft(this,Gt(t))]}),null==n||n.report({message:P.Resources.Get("Progress.ScrapeFolder")});for(let e of yield(0,be.promisify)(Mt)("**/*",{cwd:s.FullName})){if(null!==(i=null==r?void 0:r.isCancellationRequested)&&void 0!==i&&i)throw new X;(yield Et(s.MakePath(e)))&&(yield Tt(s.MakePath(e),At(Nt(t),e),{overwrite:!0}))}s.Dispose();break;default:try{let r=yield this.Browser.newPage();if(null==n||n.report({message:P.Resources.Get("Progress.ChromiumPage")}),yield r.goto(this.URL,{waitUntil:"networkidle0",timeout:0}),e===w.PDF){let e="\n                                    <style>\n                                        :root\n                                        {\n                                            font-size: 11px;\n                                        }\n                                    </style>",i={margin:{top:this.Document.Paper.Margin.Top,right:this.Document.Paper.Margin.Right,bottom:this.Document.Paper.Margin.Bottom,left:this.Document.Paper.Margin.Left},printBackground:!0,path:t};Object.assign(i,this.Document.Paper.Format.PDFOptions),this.Document.HeaderFooterEnabled&&(i.displayHeaderFooter=!0,i.headerTemplate=e+(yield this.Document.Header.Render()),i.footerTemplate=e+(yield this.Document.Footer.Render())),null==n||n.report({message:P.Resources.Get("Progress.PDF")}),yield r.pdf(i)}else{let i={fullPage:!0,path:t};switch(e){case w.JPEG:i.type="jpeg",i.quality=this.Document.Quality;break;case w.PNG:i.type="png"}null==n||n.report({message:P.Resources.Get("Progress.Screenshot")}),yield r.screenshot(i)}}catch(e){throw"object"==typeof e&&"path"in e?new ie(null,e.path):e}}}))}}var Ot=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};const Ht="script";class $t extends qe{constructor(e,t,n){super(e,t,n)}GetSource(){return Ot(this,void 0,void 0,(function*(){let e=(0,Ue.zD)((0,Ue.zD)("<script><\/script>")(Ht).toArray()[0]);return e(Ht).text((yield this.ReadFile()).toString()),`${e.html()}\n`}))}GetReferenceSource(){return Ot(this,void 0,void 0,(function*(){let e=(0,Ue.zD)((0,Ue.zD)("<script async><\/script>")(Ht).toArray()[0]),t=e(Ht);return t.attr("src",this.URL),t.attr("charset","UTF-8"),`${e.html()}\n`}))}}var jt=n(85184),zt=n.n(jt);class Wt{constructor(){this.slugs=[]}get Slugs(){return this.slugs}set Slugs(e){this.slugs=e}CreateSlug(e){let t=this.Slugify(e),n=0,r=t;for(;this.Slugs.includes(r);)r=`${t}-${++n}`;return this.Slugs.push(r),r}Reset(){this.Slugs.splice(0,this.Slugs.length)}Slugify(e){return e.replace(/[^\p{L}\p{M}\p{Nd}\p{Nl}\p{Pc}\- ]/gu,"").toLowerCase().replace(/ /g,"-")}}function Bt(e,t){let n=new Wt;e.use(zt(),Object.assign({slugify:e=>n.CreateSlug(e)},t)),e.core.ruler.before("anchor","markdownConverterAnchorInitializer",(()=>(n.Reset(),!1)))}var qt=n(34857),Yt=n.n(qt);function Jt(e,t){let n=new Wt;e.use(Yt(),Object.assign({slugify:e=>n.CreateSlug(e)},t));let r=e.renderer.rules.toc_body;e.renderer.rules.toc_body=(e,t,i,s,o)=>(n.Reset(),r(e,t,i,s,o))}const{join:Vt}=d(),{extensions:_t,Uri:Qt}=(0,i.createRequire)(D.PackageURL)("vscode");class Kt{constructor(){this.scripts=[],this.styles=[],this.loaded=!1}get PreviewScripts(){return this.Load(),this.scripts}get PreviewStyles(){return this.Load(),this.styles}static ResolveExtensionResource(e,t){return Qt.file(Vt(e.extensionPath,t)).with({scheme:"vscode-resource"})}static ResolveExtensionResources(e,t){let n=[];for(let r of t)try{n.push(Kt.ResolveExtensionResource(e,r))}catch(e){}return n}Load(){var e;if(!this.loaded){for(let t of _t.all){let n=null===(e=t.packageJSON)||void 0===e?void 0:e.contributes;n&&(this.LoadStyles(n,t),this.LoadScripts(n,t))}this.loaded=!0}}LoadScripts(e,t){let n=e["markdown.previewScripts"];n instanceof Array&&this.scripts.push(...Kt.ResolveExtensionResources(t,n))}LoadStyles(e,t){let n=e["markdown.previewStyles"];n instanceof Array&&this.styles.push(...Kt.ResolveExtensionResources(t,n))}}var Zt=n(23054),Xt=n.n(Zt);const{dirname:en,parse:tn,relative:nn}=d();class rn{constructor(e,t){let n=[];this.pattern=e,this.reporter=t;let r={basename:"",extension:"",filename:"",dirname:"",workspaceFolder:""};Xt()(e,r);for(let t of Object.keys(r)){delete r[t];try{Xt()(e,r)}catch(e){n.push(t)}r[t]=""}this.variables=n}get Pattern(){return this.pattern}get Variables(){return[...this.variables]}get Reporter(){return this.reporter}Resolve(e,t,n){var r;let i,s,o=tn(t.fileName);switch(n){case w.SelfContainedHTML:case w.HTML:i="html";break;case w.JPEG:i="jpg";break;case w.PNG:i="png";break;case w.PDF:i="pdf"}return s={filename:o.base,basename:o.name,extension:i,dirname:t.isUntitled?".":nn(e,en(t.fileName)),workspaceFolder:e},null===(r=this.Reporter)||void 0===r||r.report({message:P.Resources.Get("Progress.ResolveFileName")}),Xt()(this.Pattern,s)}}var sn=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};const{pathExists:on,readFile:an}=a(),{highlight:un}=le.Z,{dirname:ln,isAbsolute:cn,join:hn,resolve:dn}=d(),{convert:mn,parse:gn}=Se(),{window:fn,workspace:pn}=(0,i.createRequire)(D.PackageURL)("vscode");class vn{constructor(e){this.extension=e}get Extension(){return this.extension}set Extension(e){this.extension=e}Execute(e,t,n,r){var i,s,o;return sn(this,void 0,void 0,(function*(){if(null!==(i=null==n?void 0:n.isCancellationRequested)&&void 0!==i&&i)throw new X;{let i,a,u,l=[],h=this.GetWorkspacePath(e);if(i=new rn(W.Default.DestinationPattern,t),null===h)if(i.Variables.includes("workspaceFolder")||!cn(i.Pattern))for(;null===h;){if(null!==(s=null==n?void 0:n.isCancellationRequested)&&void 0!==s&&s)throw new X;h=yield fn.showInputBox({ignoreFocusOut:!0,prompt:P.Resources.Get("DestinationPath"),placeHolder:P.Resources.Get("DestinationPathExample")})}else u=new ue.F7,h=u.FullName;a=yield this.LoadConverter(h,e),yield a.Initialize(t);try{for(let s of W.Default.ConversionType){if(null!==(o=null==n?void 0:n.isCancellationRequested)&&void 0!==o&&o)throw new X;l.push((()=>sn(this,void 0,void 0,(function*(){null==t||t.report({message:c()(P.Resources.Get("Progress.ConversionStarting"),w[s])});let o=i.Resolve(h,e,s);o=cn(o)||i.Variables.includes("workspaceFolder")?dn(o):dn(h,o),yield a.Start(s,o,t,n),null==t||t.report({message:c()(P.Resources.Get("Progress.ConverterFinished"),w[s])}),null==r||r.report({Type:s,FileName:o})})))())}yield Promise.all(l)}finally{yield a.Dispose(),null==u||u.Dispose()}}}))}GetWorkspacePath(e){var t,n;let r,i=e.isUntitled?null:ln(e.fileName);return r=e.isUntitled?1===(null!==(t=pn.workspaceFolders)&&void 0!==t?t:[]).length?pn.workspaceFolders[0]:null:pn.getWorkspaceFolder(e.uri),null!==(n=null==r?void 0:r.uri.fsPath)&&void 0!==n?n:i}LoadConverter(e,t){var n,r,i,s,o,a,u,l,c,h,d,m,g,f,p,v;return sn(this,void 0,void 0,(function*(){let y=new Ut(e,new pt(yield this.LoadParser(),t)),D=null!==(n=y.Document.Attributes[Qe.MetaTemplate])&&void 0!==n?n:W.Default.MetaTemplate,w=null!==(r=y.Document.Attributes[Qe.HeaderTemplate])&&void 0!==r?r:W.Default.HeaderTemplate,R=null!==(i=y.Document.Attributes[Qe.FooterTemplate])&&void 0!==i?i:W.Default.FooterTemplate;y.ChromiumExecutablePath=null!==(s=W.Default.ChromiumExecutablePath)&&void 0!==s?s:y.ChromiumExecutablePath,y.ChromiumArgs=null!==(o=W.Default.ChromiumArgs)&&void 0!==o?o:y.ChromiumArgs,y.Document.Quality=W.Default.ConversionQuality,Object.assign(y.Document.Attributes,W.Default.Attributes),y.Document.Locale=new C.Qs(W.Default.Locale),Qe.DateFormat in y.Document.Attributes?y.Document.DefaultDateFormat=null!==(a=y.Document.Attributes[Qe.DateFormat])&&void 0!==a?a:null:y.Document.DefaultDateFormat=null!==(u=W.Default.DefaultDateFormat)&&void 0!==u?u:null;for(let e in W.Default.DateFormats)y.Document.DateFormats[e]=W.Default.DateFormats[e];y.Document.Paper=W.Default.PaperFormat,y.Document.Meta.Content=null!==(l=yield this.LoadFragment(y,D))&&void 0!==l?l:y.Document.Meta.Content,y.Document.HeaderFooterEnabled=W.Default.HeaderFooterEnabled,y.Document.Header.Content=null!==(c=yield this.LoadFragment(y,w))&&void 0!==c?c:y.Document.Header.Content,y.Document.Footer.Content=null!==(h=yield this.LoadFragment(y,R))&&void 0!==h?h:y.Document.Footer.Content;for(let e of[[y.Document.Header,Qe.Header,W.Default.HeaderContent],[y.Document.Footer,Qe.Footer,W.Default.FooterContent]]){let t=e[0],n=y.Document.Attributes[e[1]],r=e[2];t.Left=null!==(m=null!==(d=null==n?void 0:n.Left)&&void 0!==d?d:null==r?void 0:r.Left)&&void 0!==m?m:"",t.Center=null!==(f=null!==(g=null==n?void 0:n.Center)&&void 0!==g?g:null==r?void 0:r.Center)&&void 0!==f?f:"",t.Right=null!==(v=null!==(p=null==n?void 0:n.Right)&&void 0!==p?p:null==r?void 0:r.Right)&&void 0!==v?v:""}try{W.Default.Template?y.Document.Template=(yield an(dn(null!=e?e:".",W.Default.Template))).toString():W.Default.SystemParserEnabled&&(y.Document.Template=(yield an(P.Files.Get("SystemTemplate"))).toString())}catch(e){throw"object"==typeof e&&"path"in e?new ie(null,e.path):e}if(W.Default.DefaultStylesEnabled&&y.Document.StyleSheets.push(new _e(P.Files.Get("SystemStyle"),E.Include)),W.Default.SystemParserEnabled){let e=new Kt,t=[];for(let n of e.PreviewStyles){let e=new _e(n.fsPath);t.push(e),y.Document.StyleSheets.push(e)}for(let n of e.PreviewScripts){let e=new $t(n.fsPath);t.push(e),y.Document.Scripts.push(e)}for(let e of t)e.InsertionType=e.URLType===T.Link?E.Link:E.Include}"None"!==W.Default.HighlightStyle&&("Default"===W.Default.HighlightStyle?W.Default.SystemParserEnabled||y.Document.StyleSheets.push(new _e(P.Files.Get("DefaultHighlight"))):y.Document.StyleSheets.push(new _e(hn(P.Files.Get("HighlightJSStylesDir"),W.Default.HighlightStyle+".css")))),this.LoadAssets(W.Default.StyleSheets,y.Document.StyleSheets,((e,t)=>new _e(e,t,y.DocumentRoot)),W.Default.StyleSheetInsertion),this.LoadAssets(W.Default.Scripts,y.Document.Scripts,((e,t)=>new $t(e,t,y.DocumentRoot)),W.Default.ScriptInsertion);for(let e of[T.AbsolutePath,T.RelativePath,T.Link])e in W.Default.PictureInsertion&&y.Document.PictureInsertionTypes.set(e,W.Default.PictureInsertion[e]);return y}))}LoadAssets(e,t,n,r){for(let i of Object.entries(e)){let e=n(i[0],i[1]);e.InsertionType===E.Default&&e.URLType in r&&(e.InsertionType=r[e.URLType]),t.push(e)}}LoadParser(){return sn(this,void 0,void 0,(function*(){let e;return W.Default.SystemParserEnabled?(this.Extension.VSCodeParser||(yield this.Extension.EnableSystemParser()),e=he()(this.Extension.VSCodeParser),e.normalizeLink=e=>e,e.normalizeLinkText=e=>e,e.renderer.rules[vn.headingRule]=(new(me())).renderer.rules[vn.headingRule]):e=new(me())({html:!0,highlight:(t,n)=>`<pre class="hljs"><code><div>${t="None"!==W.Default.HighlightStyle?un(n,t,!0).value:e.utils.escapeHtml(t)}</div></code></pre>`}),e.validateLink=()=>!0,e.use(Bt),W.Default.TocSettings&&e.use(Jt,{includeLevel:W.Default.TocSettings.Levels.toArray(),containerClass:W.Default.TocSettings.Class,markerPattern:W.Default.TocSettings.Indicator,listType:W.Default.TocSettings.ListType===L.Ordered?"ol":"ul"}),e.use(fe()),null!==W.Default.EmojiType&&void 0!==W.Default.EmojiType&&(e.use(De()),e.renderer.rules.emoji=(e,t)=>{switch(W.Default.EmojiType){case k.None:return`:${e[t].markup}:`;case k.Native:return e[t].content;case k.Twitter:return gn(e[t].content);case k.GitHub:return`<img class="emoji" title=":${e[t].markup}:" alt=":${e[t].markup}:" src="https://github.githubassets.com/images/icons/emoji/unicode/${mn.toCodePoint(e[t].content).toLowerCase()}.png" style="vertical-align: middle; " />`}}),e.use(ve(),"markdown-converter",{validate:e=>e.trim().length>0,render:(e,t)=>""!==e[t].info.trim()?`<div class="${e[t].info.trim()}">\n`:"</div>\n"}),e.use(Ce(),{getRootDir:(e,t)=>{var n;return null!==(n=t.env[dt.RootDir])&&void 0!==n?n:"."}}),e}))}LoadFragment(e,t){return sn(this,void 0,void 0,(function*(){let n;return t&&(yield on(n=dn(e.DocumentRoot,t)))?(yield an(n)).toString():t}))}}vn.headingRule="heading_open";class yn extends B{constructor(e){super(e)}get Message(){var e;return null!==(e=super.Message)&&void 0!==e?e:P.Resources.Get("NoConversionType")}}class Dn extends B{}const{pathExists:wn}=a();class Cn extends class extends class{constructor(e){this.extension=e}get Extension(){return this.extension}get Cancellable(){return!0}}{constructor(e){super(e)}get Extension(){return super.Extension}Execute(e,t,n){var r,i,s,o,a;return i=this,s=void 0,a=function*(){if(!(yield wn(null!==(r=W.Default.ChromiumExecutablePath)&&void 0!==r?r:D.Puppeteer.executablePath())))throw new Dn;yield this.ExecuteTask(e,t,n)},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{u(a.next(e))}catch(e){t(e)}}function r(e){try{u(a.throw(e))}catch(e){t(e)}}function u(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(n,r)}u((a=a.apply(i,s||[])).next())}))}}{constructor(e){super(e),this.conversionRunner=new vn(this.Extension)}get ConversionRunner(){return this.conversionRunner}Execute(e,t,n){const r=Object.create(null,{Execute:{get:()=>super.Execute}});return i=this,s=void 0,a=function*(){if(0===W.Default.ConversionType.length)throw new yn;return r.Execute.call(this,e,t,n)},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{u(a.next(e))}catch(e){t(e)}}function r(e){try{u(a.throw(e))}catch(e){t(e)}}function u(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(n,r)}u((a=a.apply(i,s||[])).next())}));var i,s,o,a}}var Rn=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};const{extensions:Sn,workspace:xn}=(0,i.createRequire)(D.PackageURL)("vscode");class Fn extends Cn{constructor(e){super(e)}get Title(){return P.Resources.Get("TaskTitle.ConvertAll")}get Cancellable(){return!0}Execute(e,t,n){const r=Object.create(null,{Execute:{get:()=>super.Execute}});return Rn(this,void 0,void 0,(function*(){if(0===(yield this.GetDocuments()).length)throw new oe;return r.Execute.call(this,e,t,n)}))}ExecuteTask(e,t,n){var r;return Rn(this,void 0,void 0,(function*(){let i,s,o=0;null==e||e.report({message:P.Resources.Get("Progress.SearchDocuments")}),i=yield this.GetDocuments(),s=i.length,null==e||e.report({message:c()(P.Resources.Get("Progress.DocumentsFound"),s)});for(let a=0;a<i.length;a++){if(null!==(r=null==t?void 0:t.isCancellationRequested)&&void 0!==r&&r)throw new X;{let r=i[a],u={},l=(a+1)/s*100;u={message:c()(P.Resources.Get("Progress.CollectionStep"),a+1,s)},l>o&&(u.increment=l-o,o=l),yield this.ConversionRunner.Execute(r,null,t,n),null==e||e.report(u)}}}))}GetDocuments(){var e,t;return Rn(this,void 0,void 0,(function*(){let n=[],r=[];if((null!==(e=xn.workspaceFolders)&&void 0!==e?e:[]).length>0){for(let e of Sn.all)if(null===(t=e.packageJSON.contributes)||void 0===t?void 0:t.languages)for(let t of e.packageJSON.contributes.languages)if("markdown"===t.id)for(let e of t.extensions)r.push(`**/*${e}`);{let e=xn.getConfiguration().get("files.associations");for(let t in e)"markdown"===e[t]&&r.push(`**/${t}`)}for(let e of r)for(let t of yield xn.findFiles(e)){let e=yield xn.openTextDocument(t);"markdown"===e.languageId&&n.push(e)}return n}throw new ae}))}}const{renameSync:bn}=a(),{join:Pn,parse:Tn}=d(),{commands:En,window:kn,workspace:Ln}=(0,i.createRequire)(D.PackageURL)("vscode");class Mn extends Fn{constructor(e){super(e)}get Title(){return P.Resources.Get("TaskTitle.Chain")}get Cancellable(){return!1}ExecuteTask(e,t,n){return r=this,i=void 0,o=function*(){let r,i,s=null,o=[];for(null==e||e.report({message:P.Resources.Get("Progress.SearchDocuments")}),o=yield this.GetDocuments(),null==e||e.report({message:c()(P.Resources.Get("Progress.DocumentsFound"),o.length)});!s;)s=yield kn.showInputBox({ignoreFocusOut:!0,prompt:P.Resources.Get("DocumentName"),placeHolder:P.Resources.Get("DocumentNameExample")});null==e||e.report({message:P.Resources.Get("Progress.ChainDocuments")}),o.sort(((e,t)=>e.uri.toString().toLowerCase().localeCompare(t.uri.toString().toLowerCase()))),i=o.map((e=>ne()(e.getText()).body)),r=yield Ln.openTextDocument({language:"markdown",content:i.join(`${ee.EOL}${ee.EOL}<div style="page-break-after: always"></div>${ee.EOL}${ee.EOL}`)}),yield this.ConversionRunner.Execute(r,e,t,{report(e){let t=Tn(e.FileName),r=Pn(t.dir,`${s}${t.ext}`);bn(e.FileName,r),e.FileName=r,null==n||n.report(e)}}),yield kn.showTextDocument(r),yield En.executeCommand("workbench.action.revertAndCloseActiveEditor")},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{u(o.next(e))}catch(e){t(e)}}function a(e){try{u(o.throw(e))}catch(e){t(e)}}function u(t){var r;t.done?e(t.value):(r=t.value,r instanceof s?r:new s((function(e){e(r)}))).then(n,a)}u((o=o.apply(r,i||[])).next())}));var r,i,s,o}}const{window:Gn}=(0,i.createRequire)(D.PackageURL)("vscode");class Nn extends Cn{constructor(e){super(e)}get Title(){return P.Resources.Get("TaskTitle.Convert")}ExecuteTask(e,t,n){return r=this,i=void 0,o=function*(){return this.ConversionRunner.Execute(this.GetMarkdownDocument(),e,t,n)},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{u(o.next(e))}catch(e){t(e)}}function a(e){try{u(o.throw(e))}catch(e){t(e)}}function u(t){var r;t.done?e(t.value):(r=t.value,r instanceof s?r:new s((function(e){e(r)}))).then(n,a)}u((o=o.apply(r,i||[])).next())}));var r,i,s,o}GetMarkdownDocument(){if(Gn.activeTextEditor&&("markdown"===Gn.activeTextEditor.document.languageId||W.Default.IgnoreLanguageMode))return Gn.activeTextEditor.document;throw new oe}}var An=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}u((r=r.apply(e,t||[])).next())}))};const{mkdirp:In,pathExists:Un}=a(),{join:On,resolve:Hn}=d(),{commands:$n,ProgressLocation:jn,window:zn}=(0,i.createRequire)(D.PackageURL)("vscode");class Wn extends class{constructor(e){this.metaData=e,this.systemParserFixPromise=new Promise((e=>{this.systemParserFixResolver=e})),P.Culture=new C.Qs(V.language)}get ExtensionRoot(){return Y(this.MetaData.FileName)}get MetaData(){return this.metaData}get Author(){return this.MetaData.AdditionalProperties.Get("publisher")}get Name(){return this.MetaData.Name}get FullName(){return`${this.Author}.${this.Name}`}get VSCodeParser(){return this.vsCodeParser}Activate(){return q(this,void 0,void 0,(function*(){return{extension:this,extendMarkdownIt:e=>(this.vsCodeParser=e,this.resolveFix(),e)}}))}Dispose(){return q(this,void 0,void 0,(function*(){}))}EnableSystemParser(){return q(this,void 0,void 0,(function*(){return this.VSCodeParser||(yield K.showTextDocument(yield Z.openTextDocument({language:"md",content:""}),{viewColumn:Q.Beside,preview:!0}),yield J.executeCommand("markdown.showPreview"),yield J.executeCommand("workbench.action.closeActiveEditor"),yield J.executeCommand("workbench.action.closeActiveEditor")),this.systemParserFixPromise}))}ExecuteTask(e){return q(this,void 0,void 0,(function*(){try{yield this.ExecuteTaskInternal(e)}catch(e){let t;t=e instanceof Error?c()(P.Resources.Get("UnknownException"),e.name,e.message):c()(P.Resources.Get("UnknownError"),e),K.showErrorMessage(t)}}))}ExecuteTaskInternal(e){return q(this,void 0,void 0,(function*(){return K.withProgress({cancellable:e.Cancellable,location:_.Notification,title:e.Title},((t,n)=>q(this,void 0,void 0,(function*(){yield e.Execute(t,n)}))))}))}resolveFix(){this.systemParserFixResolver()}}{constructor(e){super(new s.GL(On(D.PackageDirectory,s.GL.FileName))),this.context=null,this.context=e,this.fileReporter={report(e){return An(this,void 0,void 0,(function*(){if((yield zn.showInformationMessage(c()(P.Resources.Get("SuccessMessage"),w[e.Type],e.FileName),P.Resources.Get("OpenFileLabel")))===P.Resources.Get("OpenFileLabel"))switch(process.platform){case"win32":(0,r.exec)(`"${e.FileName}"`);break;case"darwin":(0,r.exec)(`bash -c 'open "${e.FileName}"'`);break;case"linux":(0,r.exec)(`bash -c 'xdg-open "${e.FileName}"'`);break;default:zn.showWarningMessage(P.Resources.Get("UnsupportedPlatformException"))}}))}}}get Context(){return this.context}get ChromiumRevision(){return u.i.chromium}Activate(){const e=Object.create(null,{Activate:{get:()=>super.Activate}});return An(this,void 0,void 0,(function*(){return this.Context.subscriptions.push($n.registerCommand("markdownConverter.Convert",(()=>An(this,void 0,void 0,(function*(){return this.ExecuteTask(new Nn(this))})))),$n.registerCommand("markdownConverter.ConvertAll",(()=>An(this,void 0,void 0,(function*(){return this.ExecuteTask(new Fn(this))})))),$n.registerCommand("markdownConverter.Chain",(()=>An(this,void 0,void 0,(function*(){return this.ExecuteTask(new Mn(this))}))))),e.Activate.call(this)}))}ExecuteTaskInternal(e){return An(this,void 0,void 0,(function*(){try{let t=t=>An(this,void 0,void 0,(function*(){yield zn.withProgress({cancellable:e.Cancellable,location:jn.Notification,title:e.Title},((n,r)=>An(this,void 0,void 0,(function*(){yield e.Execute(n,r,t)}))))}));if(e instanceof Fn&&!(e instanceof Mn)){let e=[];yield t({report(t){e.push(t)}}),(()=>{An(this,void 0,void 0,(function*(){if((yield zn.showInformationMessage(P.Resources.Get("CollectionFinished"),P.Resources.Get("Yes"),P.Resources.Get("No")))===P.Resources.Get("Yes"))for(let t of e)this.fileReporter.report(t)}))})()}else yield t(this.fileReporter)}catch(t){if(t instanceof Dn){if(W.Default.ChromiumExecutablePath){do{if(yield Un(W.Default.ChromiumExecutablePath))return this.ExecuteTaskInternal(e)}while(!(yield Un(W.Default.ChromiumExecutablePath))&&(yield zn.showWarningMessage(P.Resources.Get("CustomBrowserNotFound"),P.Resources.Get("Yes"),P.Resources.Get("No")))===P.Resources.Get("Yes"))}else if((yield zn.showInformationMessage(P.Resources.Get("UpdateMessage"),P.Resources.Get("Yes"),P.Resources.Get("No")))===P.Resources.Get("Yes")){let t=!1,n=Hn(D.PackageDirectory,"node_modules","puppeteer-core");(yield Un(n))||(yield In(n));do{yield zn.withProgress({location:jn.Notification,title:c()(P.Resources.Get("UpdateRunning"),this.ChromiumRevision)},(n=>An(this,void 0,void 0,(function*(){try{return yield this.DownloadUpdate(n),zn.showInformationMessage(P.Resources.Get("UpdateSuccess")),t=!0,this.ExecuteTaskInternal(e)}catch(e){t=!1}}))))}while(!(yield Un(D.Puppeteer.executablePath()))&&!t&&(yield zn.showWarningMessage(P.Resources.Get("UpdateFailed"),P.Resources.Get("Yes"),P.Resources.Get("No")))===P.Resources.Get("Yes"))}}else if(t instanceof X)zn.showInformationMessage(t.Message);else{if(!(t instanceof B))throw t;zn.showErrorMessage(t.Message)}}}))}DownloadUpdate(e){return An(this,void 0,void 0,(function*(){let t=0,n=D.Puppeteer.createBrowserFetcher({});yield n.download(this.ChromiumRevision,((n,r)=>{let i=Math.floor(n/r*100);i>t&&(e.report({increment:i-t}),t=i)}))}))}}}};
//# sourceMappingURL=914.cjs.map